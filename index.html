<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rulet – Doğru Eşleşme</title>
<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#050008;
  font-family:Arial,sans-serif;
  color:#fff;
}
.wrap{text-align:center}
.wheel-wrap{
  position:relative;
  width:360px;
  height:360px;
}
.pointer{
  position:absolute;
  top:-18px;
  left:50%;
  transform:translateX(-50%);
  width:0;height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:24px solid #ff3b7a;
  z-index:5;
}
svg{
  width:100%;
  height:100%;
  border-radius:50%;
  background:#111;
  box-shadow:0 0 40px rgba(255,59,122,.6);
  transition:transform 2.8s cubic-bezier(.12,.8,.12,1);
}
.center-btn{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:96px;
  height:96px;
  border-radius:50%;
  border:none;
  background:#000;
  color:#ff7aa2;
  font-size:18px;
  font-weight:bold;
  box-shadow:0 0 25px rgba(255,59,122,.8);
  z-index:6;
}
.result{
  margin-top:12px;
  min-height:48px;
  font-size:18px;
}
</style>
</head>
<body>

<div class="wrap">
  <div class="wheel-wrap">
    <div class="pointer"></div>

    <svg id="wheel" viewBox="0 0 400 400">
      <circle cx="200" cy="200" r="190" stroke="#ff7aa2" stroke-width="4" fill="none"/>
      <g id="lines" stroke="#ff7aa2" stroke-width="2"></g>
      <g id="labels" fill="#fff" font-size="13" text-anchor="middle"></g>
    </svg>

    <button class="center-btn" id="spinBtn">ÇEVİR</button>
  </div>

  <div id="result" class="result">Çevir bakalım…</div>
</div>

<script>
const options = [
  "Göz teması",
  "Yaklaş",
  "Dokunma",
  "Fısılda",
  "Omza temas",
  "Geri çekil",
  "Nefesi hisset",
  "Sarıl",
  "Boyun",
  "Bakışı koru",
  "Yakın dur",
  "Yavaşlat",
  "Yakınlık",
  "Uyum",
  "Ritim",
  "Sessizlik"
];

const count = options.length;
const center = 200;
const radius = 190;
const slice = 360 / count;

const lines = document.getElementById("lines");
const labels = document.getElementById("labels");
const wheel = document.getElementById("wheel");

// ÇARKI ÇİZ
for(let i=0;i<count;i++){
  const a = i * slice * Math.PI / 180;

  // çizgi
  const x = center + radius * Math.cos(a);
  const y = center + radius * Math.sin(a);
  const line = document.createElementNS("http://www.w3.org/2000/svg","line");
  line.setAttribute("x1",center);
  line.setAttribute("y1",center);
  line.setAttribute("x2",x);
  line.setAttribute("y2",y);
  lines.appendChild(line);

  // yazı
  const mid = a + (slice/2) * Math.PI / 180;
  const tx = center + radius*0.65 * Math.cos(mid);
  const ty = center + radius*0.65 * Math.sin(mid);
  const text = document.createElementNS("http://www.w3.org/2000/svg","text");
  text.setAttribute("x",tx);
  text.setAttribute("y",ty);
  text.setAttribute("transform",`rotate(${mid*180/Math.PI},${tx},${ty})`);
  text.textContent = options[i];
  labels.appendChild(text);
}

// ===== SES =====
let audioCtx, timer;
function tick(){
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.frequency.value=900; g.gain.value=0.05;
  o.connect(g).connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.02);
}
function clack(){
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.frequency.value=200; g.gain.value=0.12;
  o.connect(g).connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.06);
}
function startSound(){
  audioCtx=new (window.AudioContext||webkitAudioContext)();
  let t=70;
  timer=setInterval(function run(){
    tick(); t+=14;
    clearInterval(timer);
    timer=setInterval(run,t);
  },t);
}
function stopSound(){
  clearInterval(timer);
  clack();
  setTimeout(()=>audioCtx.close(),120);
}

// ===== DÖNME + DOĞRU HESAP =====
let angle = 0;
let spinning = false;

document.getElementById("spinBtn").onclick = ()=>{
  if(spinning) return;
  spinning = true;
  startSound();

  // SADECE AÇI ÜRET
  const extra = Math.random() * 360;
  const spin = 360*4 + extra;
  angle += spin;
  wheel.style.transform = `rotate(${angle}deg)`;

  setTimeout(()=>{
    // OK HER ZAMAN 270 DERECEYİ GÖSTERİR (SVG'de yukarı)
    const normalized = (360 - (angle % 360) + 270) % 360;
    const index = Math.floor(normalized / slice) % count;

    document.getElementById("result").innerText = options[index];
    stopSound();
    spinning = false;
  },2800);
};
</script>

</body>
</html>
